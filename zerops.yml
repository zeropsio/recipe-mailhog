mailhog:
  build:
    base: [go@1]
    prepare:
      - echo "The application build is being prepared ...."
      - |
        pwd
        go install github.com/mailhog/MailHog@latest
        cd ~/go/bin
        cp MailHog /build/source/MailHog
    build: []
    deploy: [MailHog]
  run:
    prepare:
      - echo "The application runtime is being prepared ...."
      - |
        groupadd mailhog
        adduser --disabled-password --gecos "" --shell /bin/bash mailhog
        usermod -aG mailhog mailhog
        usermod -aG sudo mailhog
    init:
      - echo "The application runtime is being initialized ...."
      - |
        sudo chown -R mailhog:mailhog /var/www/MailHog
        sudo chmod -R 775 /var/www/MailHog
    start: su mailhog -c ./MailHog