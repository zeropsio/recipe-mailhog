mailhog:
  build:
    base: [go@1]
    prepare:
      - echo "The application build is being prepared ..."
      - |
        go install github.com/mailhog/MailHog@latest
    build:
      - |
        cd ~/go/bin
        cp MailHog /build/source/MailHog
    deploy: [MailHog]
  run:
    prepare:
      - echo "The application runtime is being prepared ..."
      - |
        adduser --disabled-password --gecos "" --shell /bin/bash mailhog
        usermod -aG sudo mailhog
    init:
      - echo "The application runtime is being initialized ..."
      - |
        chown mailhog:mailhog /var/www/MailHog
        chmod 775 /var/www/MailHog
    start: su mailhog -c ./MailHog